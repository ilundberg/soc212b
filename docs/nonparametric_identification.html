<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Nonparametric Identification – SOCIOL 212B: Quantitative Data Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">SOCIOL 212B: Quantitative Data Analysis</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="./problem_sets.html"> 
<span class="menu-text">Problem Sets</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./assets/syllabus.pdf"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./who_we_are.html"> 
<span class="menu-text">Who We Are</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./nonparametric_identification.html">Non-Probability Samples and Observational Causal Inference</a></li><li class="breadcrumb-item"><a href="./nonparametric_identification.html">Nonparametric identification</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./asking_a_research_question.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Asking a Research Question</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Descriptive Data Science with Probability Samples</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./yhat_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regression for Y-hat</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./algorithms_for_prediction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Algorithms for prediction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_driven_selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data-driven selection of an estimator</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./resampling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistical uncertainty by resampling</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Non-Probability Samples and Observational Causal Inference</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nonparametric_identification.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Nonparametric identification</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prediction_for_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Estimation by prediction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./weighting_for_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Estimation by weighting</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./doubly_robust.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Doubly-robust estimation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./panel_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Panel data</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Additional topics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missing_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Missing data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mediation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mediation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./scales.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Scale construction</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#fundamental-problem-of-causal-inference" id="toc-fundamental-problem-of-causal-inference" class="nav-link active" data-scroll-target="#fundamental-problem-of-causal-inference">Fundamental problem of causal inference</a></li>
  <li><a href="#mathematical-notation" id="toc-mathematical-notation" class="nav-link" data-scroll-target="#mathematical-notation">Mathematical notation</a></li>
  <li><a href="#the-consistency-assumption" id="toc-the-consistency-assumption" class="nav-link" data-scroll-target="#the-consistency-assumption">The consistency assumption</a></li>
  <li><a href="#potential-outcomes-in-math-and-in-words" id="toc-potential-outcomes-in-math-and-in-words" class="nav-link" data-scroll-target="#potential-outcomes-in-math-and-in-words">Potential outcomes in math and in words</a></li>
  <li><a href="#exchangeability-in-simple-random-samples" id="toc-exchangeability-in-simple-random-samples" class="nav-link" data-scroll-target="#exchangeability-in-simple-random-samples">Exchangeability in simple random samples</a></li>
  <li><a href="#exchangeability-in-randomized-experiments" id="toc-exchangeability-in-randomized-experiments" class="nav-link" data-scroll-target="#exchangeability-in-randomized-experiments">Exchangeability in randomized experiments</a></li>
  <li><a href="#causal-identification" id="toc-causal-identification" class="nav-link" data-scroll-target="#causal-identification">Causal identification</a></li>
  <li><a href="#conditional-exchangeability" id="toc-conditional-exchangeability" class="nav-link" data-scroll-target="#conditional-exchangeability">Conditional exchangeability</a></li>
  <li><a href="#conditional-average-treatment-effects" id="toc-conditional-average-treatment-effects" class="nav-link" data-scroll-target="#conditional-average-treatment-effects">Conditional average treatment effects</a></li>
  <li><a href="#observational-studies-call-for-dags" id="toc-observational-studies-call-for-dags" class="nav-link" data-scroll-target="#observational-studies-call-for-dags">Observational studies call for DAGs</a></li>
  <li><a href="#nodes-edges-and-paths" id="toc-nodes-edges-and-paths" class="nav-link" data-scroll-target="#nodes-edges-and-paths">Nodes, edges, and paths</a></li>
  <li><a href="#causal-paths" id="toc-causal-paths" class="nav-link" data-scroll-target="#causal-paths">Causal paths</a></li>
  <li><a href="#fork-structures" id="toc-fork-structures" class="nav-link" data-scroll-target="#fork-structures">Fork structures</a></li>
  <li><a href="#collider-structures" id="toc-collider-structures" class="nav-link" data-scroll-target="#collider-structures">Collider structures</a></li>
  <li><a href="#open-and-blocked-paths" id="toc-open-and-blocked-paths" class="nav-link" data-scroll-target="#open-and-blocked-paths">Open and blocked paths</a></li>
  <li><a href="#determining-statistical-dependence" id="toc-determining-statistical-dependence" class="nav-link" data-scroll-target="#determining-statistical-dependence">Determining statistical dependence</a></li>
  <li><a href="#causal-identification-with-dags" id="toc-causal-identification-with-dags" class="nav-link" data-scroll-target="#causal-identification-with-dags">Causal identification with DAGs</a></li>
  <li><a href="#how-to-draw-a-dag" id="toc-how-to-draw-a-dag" class="nav-link" data-scroll-target="#how-to-draw-a-dag">How to draw a DAG</a></li>
  <li><a href="#what-to-read" id="toc-what-to-read" class="nav-link" data-scroll-target="#what-to-read">What to read</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./nonparametric_identification.html">Non-Probability Samples and Observational Causal Inference</a></li><li class="breadcrumb-item"><a href="./nonparametric_identification.html">Nonparametric identification</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Nonparametric Identification</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<!-- [slides](../slides/lec07_define_causal/lec07.pdf) -->
<p>The course so far has focused on descriptive claims. For example, we have estimated the average value of an outcome in the population, or among population subgroups. This lecture pivots to causal claims: what would happen if a population were exposed to a hypothetical intervention.</p>
<section id="fundamental-problem-of-causal-inference" class="level2">
<h2 class="anchored" data-anchor-id="fundamental-problem-of-causal-inference">Fundamental problem of causal inference</h2>
<p>Health professionals often advise people to eat a Mediterranean diet high in healthy fats such as olive oil, whole grains, and fruits. There is descriptive evidence that lifespans are longer among people who eat a Mediterranean diet compared with among people who eat a standard diet. But does eating a Mediterranean diet cause longer lifespan? The figure below visualizes this question in the potential outcomes framework.</p>
<p><img src="assets/figures/mediterranean_science_table.png" class="img-fluid"></p>
<p>In this hypothetical example, each row corresponds to a person. Person 1 follows a Mediterranean diet and is observed to have a lifespan indicated in blue. Person 2 does not follow a Mediterranean diet and is observed to have a lifespan indicated in green. The descriptive evidence is that lifespans are longer among those eating a Mediterranean diet (blue outcomes on the left) compared with those eating standard diets (green outcomes on the left).</p>
<p>The right side of the figure corresponds to the causal claim, which is different. Person 1 has two <strong>potential outcomes</strong>: a lifespan that would be realized under a Mediterranean diet and a lifespan that would be realized under a standard diet. The causal effect for Person 1 is the difference between the lifespans that would be realized for that person under each of the two diets. But there is a fundamental problem: person 1 ate a Mediterranean diet, and we did not get to observe their outcome under a standard diet. The fundamental problem of causal inference (<a href="https://www.tandfonline.com/doi/abs/10.1080/01621459.1986.10478354">Holland 1986</a>) is that causal claims involve a contrast between potential outcomes, but for each unit only one of these potential outcomes is realized. The other is counterfactual and cannot be directly observed.</p>
<p>We will need additional argument and assumptions to use the factual data (left side of the figure) in order to produce answers about causal effects (right side of the figure). Causal inference is a missing data problem insofar as many of the potential outcomes we need are missing.</p>
</section>
<section id="mathematical-notation" class="level2">
<h2 class="anchored" data-anchor-id="mathematical-notation">Mathematical notation</h2>
<p>Because each person has more than one potential outcome, we need new mathematical notation to formalize causal claims. We will use subscripts to indicate units (rows of our data). Let <span class="math inline">\(Y_i\)</span> be the outcome for person <span class="math inline">\(i\)</span>, such as whether person <span class="math inline">\(i\)</span> survived. Let <span class="math inline">\(A_i\)</span> be the treatment of person <span class="math inline">\(i\)</span>, for example taking the value or the value . To refer more abstractly to a value the treatment could take, we use the lower case notation <span class="math inline">\(a\)</span> for a treatment value. Define potential outcomes <span class="math inline">\(Y_i^\text{MediterraneanDiet}\)</span> and <span class="math inline">\(Y_i^\text{StandardDiet}\)</span> as the lifespan outcomes that person <span class="math inline">\(i\)</span> would realize under each of the treatment conditions. More generally, let <span class="math inline">\(Y_i^a\)</span> denote the potential outcome for unit <span class="math inline">\(i\)</span> that would be realized if assigned to treatment value <span class="math inline">\(a\)</span>.</p>
<p>The causal effect is a contrast across potential outcomes. For example, the causal effect on Ian’s lifespan of eating a Mediterranean diet versus a standard diet is <span class="math display">\[Y_\text{Ian}^\text{MediterraneanDiet} - Y_\text{Ian}^\text{StandardDiet}\]</span></p>
<p>To connect causal claims to ideas we have already covered from sampling, we will adopt a framework in which potential outcomes are fixed quantities with randomness arising from sampling and/or from random treatment assignment. Each person has a fixed outcome <span class="math inline">\(Y_i^\text{MediterraneanDiet}\)</span> that would be observed if they were sampled and assigned a Mediterranean diet. This is just like how every baseball player from last week had a salary that would be observed if they were sampled. We will sometimes omit the <span class="math inline">\(i\)</span> subscript to refer to the random variable for the potential outcome of a randomly-sampled person from the population, <span class="math inline">\(Y^\text{MediterraneanDiet}\)</span>.</p>
</section>
<section id="the-consistency-assumption" class="level2">
<h2 class="anchored" data-anchor-id="the-consistency-assumption">The consistency assumption</h2>
<p>We want to make causal claims about potential outcomes <span class="math inline">\(Y_i^a\)</span>, but what we observe are factually realized outcome <span class="math inline">\(Y_i\)</span>. To draw the connection, we need to assume that the factual outcomes are consistent with what would be observed if the person in question were assigned to the treatment condition that factually observed. Using <span class="math inline">\(A_i\)</span> to denote the factual treatment for person <span class="math inline">\(i\)</span>, we assume</p>
<p><span class="math display">\[
Y_i^{A_i} = Y_i \qquad\text{(consistency assumption)}
\]</span> This assumption is often obviously true, but we will see later examples where it is violated. One example is when person <span class="math inline">\(i\)</span>’s outcome depends not only on their own treatment but also on the treatment of some neighboring person <span class="math inline">\(j\)</span>. In many of our initial examples, we will simply assume the consistency assumption holds.</p>
</section>
<section id="potential-outcomes-in-math-and-in-words" class="level2">
<h2 class="anchored" data-anchor-id="potential-outcomes-in-math-and-in-words">Potential outcomes in math and in words</h2>
<p>We will often use potential outcomes within mathematical statements. For example, we might write about the expected outcome if assigned to a Mediterranean diet, <span class="math inline">\(E(Y^\text{MediterraneanDiet})\)</span>. Recall that the expectation operator <span class="math inline">\(E()\)</span> says to take the population mean of the random variable within the parentheses. We will also use conditional expectations, such as <span class="math inline">\(E(Y\mid A = \text{MediterraneanDiet})\)</span> which reads “the expected value of <span class="math inline">\(Y\)</span> given that <span class="math inline">\(A\)</span> took the value .” The vertical bar says that we are taking the expected value of the variable on the left of the bar within the subgroup defined on the right side of the bar.</p>
<p>In class, we practiced writing statements in math and in English. For example, the mathematical statement <span class="math display">\[
E(\text{Earning} \mid \text{CollegeDegree} = \texttt{TRUE}) &gt; E(\text{Earning} \mid \text{CollegeDegree} = \texttt{FALSE})
\]</span> is a descriptive statement that says the expected value of earnings is higher among the subgroup with college degrees than among those without college degrees. We made these kinds of descriptive claims already in code by using <code>group_by()</code> and <code>summarize()</code>.</p>
<p>The mathematical statement <span class="math display">\[
E\left(\text{Earning}^{\text{CollegeDegree} = \texttt{TRUE}}\right) &gt; E\left(\text{Earning}^{\text{CollegeDegree} = \texttt{FALSE}}\right)
\]</span> is a causal claim that the expected value of earnings that a random person would realize if assigned to a college degree is higher than the expected value if a random person were assigned to no college degree. Because there is no vertical bar (<span class="math inline">\(\mid\)</span>), the causal claim is an average over the entire population on both sides of the inequality. The descriptive claim, by contrast, is an average over two different sets of units. The figure below visualizes the difference between these descriptive and causal claims using a visual analogous to the one used to introduce a Mediterranean diet.</p>
<p><img src="assets/figures/college_science_table.png" class="img-fluid"></p>
</section>
<section id="exchangeability-in-simple-random-samples" class="level2">
<h2 class="anchored" data-anchor-id="exchangeability-in-simple-random-samples">Exchangeability in simple random samples</h2>
<p>Causal effects involve both factual and counterfactual outcomes, yet data that we can observe involve only factual outcomes. To learn about causal effects from data that can be observed requires assumptions about the data that are not observed. One way to learn about that is by making an assumption known as <strong>exchangeability</strong>.</p>
<p>The figure below illustrates a population of 6 people. Each person has an outcome <span class="math inline">\(Y_i\)</span>, which for example might be that person’s employment at age 40. A researcher draws a random sample without replacement with equal sampling probabilities and records the sampled outcomes. The researcher uses the average of the sampled outcomes as an estimator for the population mean.</p>
<p><img src="assets/figures/exchangeability_sampling.png" width="60%" height="60%"></p>
<p>Why do probability samples like this work? They work because selection into the sample (<span class="math inline">\(S = 1\)</span>) is completely randomized and thus independent of the outcome <span class="math inline">\(Y\)</span>. In other words, the people who are sampled (<span class="math inline">\(S = 1\)</span>) and the people who are unsampled (<span class="math inline">\(S = 0\)</span>) have the same distribution of outcomes (at least in expectation over samples). We might say that the sampled and the unsampled units are <strong>exchangeable</strong> in the sense that they follow the same distribution in terms of <span class="math inline">\(Y\)</span>. In math, exchangeable sampling can be written as follows.</p>
<p><span class="math display">\[
\underbrace{Y}_\text{Outcome}\quad \underbrace{\mathrel{\unicode{x2AEB}}}_{\substack{\text{Is}\\\text{Independent}\\\text{of}}} \quad \underbrace{S}_{\substack{\text{Sample}\\\text{Inclusion}}}
\]</span></p>
<p>Exchangeability holds in simple random samples because sampling is completely independent of all outcomes by design. In other types of sampling, such as convenience samples that enroll anyone who is interested, exchangeability may hold but is far from guaranteed. Perhaps people who are employed are more likely to answer a survey about employment, so that the employment rate in a convenience sample might far exceed the population mean employment rate. Exchangeability is one condition under which reliable population estimates can be made from samples, and probability samples are good because they make exchangeability hold by design.</p>
</section>
<section id="exchangeability-in-randomized-experiments" class="level2">
<h2 class="anchored" data-anchor-id="exchangeability-in-randomized-experiments">Exchangeability in randomized experiments</h2>
<p>The figure below illustrates our population if they all enrolled in a hypothetical randomized experiment. In this experiment, we imagine that each unit is either randomized to attain a four-year college degree (<span class="math inline">\(A = 1)\)</span> or to finish education with a high school diploma (<span class="math inline">\(A = 0\)</span>).</p>
<p><img src="assets/figures/exchangeability_treatment.png" class="img-fluid"></p>
<p>In this randomization, Maria, Sarah, and Jes'us were randomized to attain a four-year college degree. We observe their outcomes under this treatment condition (<span class="math inline">\(Y^1\)</span>). Because treatment was randomized with equal probabilities, these three units form a simple random sample from the full population of 6 people. We could use the sample mean of <span class="math inline">\(Y^1\)</span> among the treated units (Maria, Sarah, Jes'us) as an estimator of the population mean of <span class="math inline">\(Y^1\)</span> among all 6 units.</p>
<p>William, Rich, and Alondra were randomized to finish their education with a high school diploma. We see their outcomes under this control condition <span class="math inline">\(Y^0\)</span>. Their treatment assignment (<span class="math inline">\(A = 0\)</span>) is analogous to being sampled from the population of <span class="math inline">\(Y^0\)</span> values. We can use their sample mean outcome as an estimator of the population mean of <span class="math inline">\(Y^0\)</span>.</p>
<p>Formally, we can write the exchangeability assumption for treatment assignments as requiring that the set of potential outcomes are independent of treatment assignment.</p>
<p><span class="math display">\[
\underbrace{\{Y^1,Y^0\}}_{\substack{\text{Potential}\\\text{Outcomes}}}\quad\underbrace{\mathrel{\unicode{x2AEB}}}_{\substack{\text{Are}\\\text{Independent}\\\text{of}}}\quad  \underbrace{A}_\text{Treatment}
\]</span> Exchangeability holds in randomized experiments because treatment is completely independent of all potential outcomes by design. In observational studies, where treatment values are observed but are not assigned randomly by the researcher, exchangeability may hold but is far from guaranteed. In the coming classes, we will talk about generalizations of the exchangeability assumption that one can argue might hold in some observational settings.</p>
</section>
<section id="causal-identification" class="level2">
<h2 class="anchored" data-anchor-id="causal-identification">Causal identification</h2>
<p>A population-average causal effect could take many possible values. Using data alone, it is impossible to identify which of these many possible values is the correct one. By pairing data together with causal assumptions, however, one can <strong>identify</strong> the average causal effect by equating it with a statistical quantity that only involves observable random variables.</p>
<blockquote class="blockquote">
<p><strong>Causal identification.</strong> A mathematical proof linking a causal estimand (involving potential outcomes) to a statistical quantity involving only factual random variables.</p>
</blockquote>
<p>In a randomized experiment, the average causal effect is identified by the assumptions of consistency and exchangeability. A short proof can yield insight about the goals and how these assumptions are used.</p>
<p><span class="math display">\[
\begin{aligned}
&amp;\overbrace{\text{E}\left(Y^1\right) - \text{E}\left(Y^0\right)}^{\substack{\text{Average}\\\text{causal effect}\\\text{(among everyone)}}} \\
&amp;= \text{E}\left(Y^1\mid A = 1\right) - \text{E}\left(Y^0\mid A = 0\right) &amp;\text{by exchangeability}\\
&amp;= \underbrace{\text{E}\left(Y\mid A = 1\right)}_{\substack{\text{Mean outcome}\\\text{among the treated}}} - \underbrace{\text{E}\left(Y\mid A = 0\right)}_{\substack{\text{Mean outcome}\\\text{among the untreated}}} &amp;\text{by consistency}
\end{aligned}
\]</span></p>
<p>The proof begins with the average causal effect and equates it to a statistical estimand: the mean outcome among the treated minus the mean outcome among the untreated. The first quantity involves potential outcomes (with superscripts), whereas the last quantity involves only factual random variables.</p>
<p>The exchangeability assumption allows us to move from the first line to the second line. Under exchangeability, the mean outcome that would be realized under treatment (<span class="math inline">\(\text{E}(Y^1)\)</span>) equals the mean outcome under treatment among those who were actually treated (<span class="math inline">\(\text{E}(Y^0)\)</span>). Likewise for outcomes under no treatment. This line is true because the treated (<span class="math inline">\(A = 1\)</span>) and the untreated (<span class="math inline">\(A = 0\)</span>) are both simple random samples from the full population.</p>
<p>The consistency assumption allows us to move from the second line to the third. Among the treated, (<span class="math inline">\(A = 1\)</span>), the outcome that is realized is <span class="math inline">\(Y = Y^1\)</span>. Among the untreated (<span class="math inline">\(A = 0\)</span>), the outcome that is realized is <span class="math inline">\(Y = Y^0\)</span>. Under the assumption that factual outcomes are consistent with the potential outcomes under the assigned treatment, the second line equal the third.</p>
<p>Something nice about a causal identification proof is that there is no room for error: it is mathematically true that the premise and the assumptions together yield the result. As long as the assumptions hold, the statistical estimand equals the causal estimand. Causal inference thus boils down to research designs and arguments that can lend credibility to the assumptions that let us draw causal claims from data that are observed.</p>
</section>
<section id="conditional-exchangeability" class="level2">
<h2 class="anchored" data-anchor-id="conditional-exchangeability">Conditional exchangeability</h2>
<p>Conditional exchangeability is an assumption that exchangeability holds within population subgroups. This assumption holds by design in a conditionally randomized experiment, and may hold under certain causal beliefs in observational settings where the treatment is not randomized.</p>
<p>Suppose we were to carry out an experiment on a simple random sample of U.S. high school students. Among those performing in the top 25% of their high school class, we randomize 80% to attain a four-year college degree. Among those performing in the bottom 75% of their high school class, we randomize 20% to attain a four-year college degree. We are interested in effects on employment at age 40 (<span class="math inline">\(Y\)</span>).</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="nonparametric_identification_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This experiment is <strong>conditionally randomized</strong> because the probability of treatment (four-year degree) is different among the higher- and lower-performing high school students.</p>
<blockquote class="blockquote">
<p><strong>Conditionally randomized experiment.</strong> An experiment in which the probability of treatment assignment depends on the values of pre-treatment covariates. <span class="math inline">\(\text{P}(A = 1\mid\vec{X} = \vec{x})\)</span> depends on the value <span class="math inline">\(\vec{x}\)</span>.</p>
</blockquote>
<p>In a conditionally randomized experiment, exchangeability is not likely to hold. People who are treated (assigned to a four-year degree) are more likely to have come from the top 25% of their high school class. They might be especially hard-working people. The treated and untreated might have had different employment at age 40 even if none of them had been treated.</p>
<p>Even though exchangeability does not hold marginally (across everyone), in a conditionally randomized experiment exchangeability does hold within subgroups. If we focus on those in the top 25% of the class, the 90% who are assigned to finish college are a simple random sample of the entire higher-performing subgroup. If we focus on those in the bottom 75% of the class, the 10% who are assigned to finish college are a simple random sample of the entire lower-performing subgroup.</p>
<p>Formally, conditional exchangeability takes the exchangeability assumption (<span class="math inline">\(\{Y^0,Y^1\}\unicode{x2AEB}A\)</span>) and adds a conditioning bar <span class="math inline">\(\mid\vec{X}\)</span>, meaning that this assumption holds within subgroups defined by one or more pre-treatment variables <span class="math inline">\(\vec{X}\)</span>.</p>
<blockquote class="blockquote">
<p><strong>Conditional exchangeability.</strong> The assumption that potential outcomes <span class="math inline">\(\{Y^0,Y^1\}\)</span> are independent of treatment <span class="math inline">\(A\)</span> among subpopulations that are identical along a set of pre-treatment covariates <span class="math inline">\(\vec{X}\)</span>. Formally, <span class="math inline">\(\{Y^0,Y^1\} \unicode{x2AEB} A \mid \vec{X}\)</span>.</p>
</blockquote>
<p>Conditional exchangeability holds by design in conditionally randomized experiments: the probability of treatment assignment differs across subgroups, but within each subgroup we have a simple randomized experiment where each unit has an equal probability of being treated.</p>
</section>
<section id="conditional-average-treatment-effects" class="level2">
<h2 class="anchored" data-anchor-id="conditional-average-treatment-effects">Conditional average treatment effects</h2>
<p>In our conditionally randomized experiment, we could identify conditional average treatment effects: the average effects of college on employment at age 40 (1) among those in the top 25% of their high school class, and the and (2) among those in the bottom 75% of their high school class.</p>
<blockquote class="blockquote">
<p><strong>Conditional average treatment effect (CATE).</strong> The average causal effect within a population subgroup, <span class="math inline">\(\tau(x) = \text{E}\left(Y^1\mid\vec{X} = \vec{x}\right) - \text{E}\left(Y^0\mid \vec{X} = \vec{x}\right)\)</span>.</p>
</blockquote>
<p>Once we assume conditional exchangeability and consistency, CATEs are causally identified by working within a subgroup defined by <span class="math inline">\(\vec{X} = \vec{x}\)</span> and taking the difference in means across subgroups of units assigned to treatment and control.</p>
<p><span class="math display">\[
\begin{aligned}
&amp;\text{E}\left(Y^1\mid\vec{X} = \vec{x}\right) -  \text{E}\left(Y^0\mid\vec{X} = \vec{x}\right)\\
&amp;= \text{E}\left(Y\mid\vec{X} = \vec{x}, A = 1\right) - \text{E}\left(Y\mid\vec{X} = \vec{x}, A = 0\right)
\end{aligned}
\]</span></p>
<p>In our concrete example, this means that we could first focus on the subgroup for whom <span class="math inline">\(\vec{X} = (\text{Top 25\% of high school class})\)</span>. Within this subgroup, we can compare employment at age 40 among those randomized to a 4-year college degree to employment at age 40 among those randomized to finish education after high school. This mean difference identifies the CATE: the average causal effect of college among those in the top 25% of their high school class.</p>
<p>Likewise, our experiment would also identify the CATE among those in the bottom 75% of their high school class.</p>
<p>There are often good reasons to expect the Conditional Average Treatment Effect (CATE) to differ across subpopulations. In our example, suppose that those from the top 25% of the high school class are very creative and hard-working, and would find ways to be employed at age 40 regardless of whether they finished college. The average causal effect of college on employment in this subgroup might be small. Meanwhile, the average causal effect of college on employment might be quite large among those from the bottom 75% of their high school class. This would be an example of effect heterogeneity,</p>
<blockquote class="blockquote">
<p><strong>Effect heterogeneity.</strong> Differences in Conditional Average Treatment Effects (CATEs) across subpopulations. <span class="math inline">\(\tau(\vec{x})\neq\tau(\vec{x}')\)</span>.</p>
</blockquote>
<p>An advantage of analyzing randomized experiments conditionally (within subgroups) is that one can search for effect heterogeneity.</p>
</section>
<section id="observational-studies-call-for-dags" class="level2">
<h2 class="anchored" data-anchor-id="observational-studies-call-for-dags">Observational studies call for DAGs</h2>
<p>The material above focused on randomized experiments in which the researcher randomizes the treatment variable. In a randomized experiment, the researcher knows the probability with which treatment was assigned to each unit. Either exchangeability or conditional exchangeability holds by design. Many social science studies, however, focus on questions in which randomization is infeasible due to high costs or even the impossibility of randomizing a treatment. Many social science studies are therefore observational studies.</p>
<blockquote class="blockquote">
<p><strong>Observational study.</strong> A study seeking to answer a causal question in which the researcher has not randomized the treatment variable.</p>
</blockquote>
<p>Where randomized experiments call for precise research design in which the researcher assigns the treatment, observational studies call for precise theory about how the world has assigned the treatments and how the world has generated outcomes. Directed Acyclic Graphs (DAGs) are a tool to formalize causal assumptions mathematically in graphs.</p>
<blockquote class="blockquote">
<p><strong>Directed Acyclic Graph (DAG).</strong> A mathematical graph involving nodes and edges, where all edges are directed and there are no cycles. See below for definitions of nodes and edges.</p>
</blockquote>
<p>DAGs are especially helpful in observational studies because they provide rules for selecting a sufficient adjustment set (<span class="math inline">\(\vec{X}\)</span>) such that conditional exchangeability holds.</p>
</section>
<section id="nodes-edges-and-paths" class="level2">
<h2 class="anchored" data-anchor-id="nodes-edges-and-paths">Nodes, edges, and paths</h2>
<p>Consider again our conditionally randomized experiment in which the researcher assigned participants to the treatment condition of (four-year college degree) vs (high school degree) with probabilities that depended on high school class rank. In this experiment, being in the top 25% of one’s high school class caused a higher chance of receiving the treatment. We will also assume that both high school performance and college completion may causally shape employment at age 40.</p>
<p>We can formalize these ideas in a graph where each <strong>node</strong> (a letter) is a variable and each <strong>edge</strong> (<span class="math inline">\(\rightarrow\)</span>) is a causal relationship.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="nonparametric_identification_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Between each pair of nodes, you can enumerate every <strong>path</strong> or sequence of edges connecting the nodes.</p>
<blockquote class="blockquote">
<p><strong>Path.</strong> A path between nodes <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> is any set of edges that starts at <span class="math inline">\(A\)</span> and ends at <span class="math inline">\(B\)</span>. Paths can involve arrows in either direction.</p>
</blockquote>
<p>In our DAG above, there are two paths between <span class="math inline">\(A\)</span> and <span class="math inline">\(Y\)</span>.</p>
<ol type="1">
<li><span class="math inline">\(A\rightarrow Y\)</span></li>
<li><span class="math inline">\(A\leftarrow X \rightarrow Y\)</span></li>
</ol>
<p>We use paths to determine the reasons why <span class="math inline">\(A\)</span> and <span class="math inline">\(Y\)</span> might be statistically dependent or independent.</p>
</section>
<section id="causal-paths" class="level2">
<h2 class="anchored" data-anchor-id="causal-paths">Causal paths</h2>
<p>The first type of path that we consider is a causal path.</p>
<blockquote class="blockquote">
<p><strong>Causal path.</strong> A path in which all arrows point in the same direction. For example, <span class="math inline">\(A\)</span> and <span class="math inline">\(D\)</span> could be connected by a causal path <span class="math inline">\(A\rightarrow B \rightarrow C \rightarrow D\)</span>.</p>
</blockquote>
<p>A causal path creates statistical depends between the nodes because the first node causes the last node, possibly through a sequence of other nodes.</p>
<p>In our example, there is a causal path <span class="math inline">\(A\rightarrow Y\)</span>: being assigned to a four-year college degree affects employment at age 40. Because of this causal path, people who are assigned to a four-year degree have different rates of employment at age 40 than those who are not.</p>
<p>A causal path can go through several variables. For example, if we listed the paths between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> we would include the path <span class="math inline">\(X\rightarrow A \rightarrow Y\)</span>. This is a causal path because being in the top 25% of one’s high school class increases the probability of assignment to a four-year degree in our experiment, which in turn increases the probability of employment at age 40.</p>
</section>
<section id="fork-structures" class="level2">
<h2 class="anchored" data-anchor-id="fork-structures">Fork structures</h2>
<p>To reason about non-causal paths, we have to think about several structures that can exist along these paths. The first such structure is a fork structure.</p>
<blockquote class="blockquote">
<p><strong>Fork structure.</strong> A fork structure is a sequence of edges in which two variables (<span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>) are both caused a third variable (<span class="math inline">\(C\)</span>): <span class="math inline">\(A\leftarrow C \rightarrow B\)</span>.</p>
</blockquote>
<p>In our example, the path <span class="math inline">\(A\leftarrow X \rightarrow Y\)</span> involves a fork structure. being in the top 25% of one’s high school class causally affects both the treatment (college degree) and the outcome (employment at age 40).</p>
<p>A fork structure creates statistical dependence between <span class="math inline">\(A\)</span> and <span class="math inline">\(Y\)</span> that does not correspond to a causal effect of <span class="math inline">\(A\)</span> on <span class="math inline">\(Y\)</span>. In our example, people who are assigned to the treatment value (college degree) are more likely to have been in the top 25% of their high school class, since this high class rank affected treatment assignment in our experiment. A high class rank also affected employment at age 40. Thus, in our experiment the treatment would be associated with the outcome even if finishing college had no causal effect on employment.</p>
<p>Fork structures can be <strong>blocked</strong> by conditioning on the common cause. In our example, suppose we filter our data to only include those in the top 25% of their high school class. We sometimes use a box to denote conditioning on a variable, (<span class="math inline">\(A\leftarrow\boxed{X}\rightarrow Y\)</span>). Conditioning on <span class="math inline">\(X\)</span> blocks the path because within this subgroup <span class="math inline">\(X\)</span> does not vary, so it cannot cause the values of <span class="math inline">\(A\)</span> and <span class="math inline">\(Y\)</span> within the subgroup. In our example, if we looked among those in the top 25% of their high school classes the only reason college enrollment would be related to employment at age 40 would be the causal effect <span class="math inline">\(A\rightarrow Y\)</span>.</p>
<p>To emphasize ideas, it is also helpful to consider a fork structure in an example where the variables have no causal relationship.</p>
<p>Suppose a beach records for each day the number of ice cream cones sold and the number of rescues by lifeguards. There is no causal effect between these two variables; eating ice cream does not cause more lifeguard rescues and vice versa. But the two are correlated because they share a common cause: warm temperatures cause high ice cream sales and also high lifeguard rescues. A fork structure formalizes this notion: <span class="math inline">\((\text{ice cream sales}) \leftarrow (\text{warm temperature}) \rightarrow (\text{lifeguard rescues})\)</span>.</p>
<p>In the population of days as a whole, this fork structure means that ice cream sales are related to lifeguard rescues. But if we condition on having a warm temperature by filtering to days when the temperature took a particular value, ice cream sales would be unrelated to lifeguard rescues across those days. This is the sense in which conditioning on the common cause variable blocks the statistical associations that would otherwise arise from a fork structure.</p>
</section>
<section id="collider-structures" class="level2">
<h2 class="anchored" data-anchor-id="collider-structures">Collider structures</h2>
<p>In contrast to a fork structure where one variable affects two others (<span class="math inline">\(\bullet\leftarrow\bullet\rightarrow\bullet\)</span>), a <strong>collider structure</strong> is a structure where one variable is affected by two others.</p>
<blockquote class="blockquote">
<p><strong>Collider structure.</strong> A collider structure is a sequence of edges in which two variables (<span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>) both cause a third variable (<span class="math inline">\(C\)</span>). We say that <span class="math inline">\(C\)</span> is a <strong>collider</strong> on the path <span class="math inline">\(A\rightarrow C \leftarrow B\)</span>.</p>
</blockquote>
<p>Fork and collider structures have very different properties, as we will illustrate through an example.</p>
<p>Suppose that every day I observe whether the grass on my lawn is wet. I have sprinklers that turn on with a timer at the same time every day, regardless of the weather. It also sometimes rains. When the grass is wet, it is wet because either the sprinklers have been on or it has been raining.</p>
<p><span class="math display">\[
(\text{sprinklers on}) \rightarrow (\text{grass wet}) \leftarrow (\text{raining})
\]</span></p>
<p>If I look across all days, the variable (sprinklers on) is unrelated to the variable (raining). After all, the sprinklers are just on a timer! Formally, we say that even though (sprinklers on) and (raining) are connected by the path above, this path is <strong>blocked</strong> by the collider structure. A path does not create dependence between two variables when it contains a collider structure.</p>
<p>If I look only at the days when the grass is wet, a different pattern emerges. If the grass is wet and the sprinklers have not been on, then it must have been raining: the grass had to get wet somehow. If the grass is wet and it has not been raining, then the sprinklers must have been on. Once I look at days when the grass is wet (or <strong>condition</strong> on the grass being wet), the two input variables become statistically associated.</p>
<p>A collider blocks a path when that collider is left unadjusted, but conditioning on the collider variable opens the path containing the collider.</p>
</section>
<section id="open-and-blocked-paths" class="level2">
<h2 class="anchored" data-anchor-id="open-and-blocked-paths">Open and blocked paths</h2>
<p>A central purpose of a DAG is to connect causal assumptions to implications about associations that should be present (or absent) in data under those causal assumptions. To make this connection, we need a final concept of open and blocked paths.</p>
<blockquote class="blockquote">
<p>A path is <strong>blocked</strong> if it contains an unconditioned collider or a conditioned non-collider. Otherwise, the path is <strong>open</strong>. An open path creates statistical dependence between its terminal nodes whereas a blocked path does not.</p>
</blockquote>
<p>As examples for a path with no colliders,</p>
<ul>
<li><span class="math inline">\(A\leftarrow B \rightarrow C \rightarrow D\)</span> is an open path because no variables are conditioned and it contains no colliders.</li>
<li><span class="math inline">\(A\leftarrow \boxed{B}\rightarrow C \rightarrow D\)</span> is a blocked path because we have conditioned on the non-collider <span class="math inline">\(B\)</span>.</li>
<li><span class="math inline">\(A\leftarrow  B\rightarrow \boxed{C} \rightarrow D\)</span> is a blocked path because we have conditioned on the non-collider <span class="math inline">\(C\)</span>.</li>
</ul>
</section>
<section id="determining-statistical-dependence" class="level2">
<h2 class="anchored" data-anchor-id="determining-statistical-dependence">Determining statistical dependence</h2>
<p>We are now ready to use DAGs to determine if <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are statistically dependent. The process involves three steps.</p>
<ol type="1">
<li>List all paths between <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>.</li>
<li>Cross out any paths that are blocked.</li>
<li>The causal assumptions imply that <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> may be statistically dependent only if any open paths remain.</li>
</ol>
<p>As an example, below we consider a hypothetical DAG.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="nonparametric_identification_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>1. Marginal dependence</strong></p>
<p>Marginally without any adjustment, are <span class="math inline">\(A\)</span> and <span class="math inline">\(D\)</span> statistically dependent? We first write out all paths connecting <span class="math inline">\(A\)</span> and <span class="math inline">\(D\)</span>.</p>
<ul>
<li><span class="math inline">\(A\rightarrow B \leftarrow C\rightarrow D\)</span></li>
<li><span class="math inline">\(A\leftarrow X\rightarrow D\)</span></li>
</ul>
<p>We then cross out the paths that are blocked</p>
<ul>
<li><span class="math inline">\(\cancel{A\rightarrow B \leftarrow C\rightarrow D}\)</span> (blocked by unconditioned collider <span class="math inline">\(B\)</span>)</li>
<li><span class="math inline">\(A\leftarrow X\rightarrow D\)</span></li>
</ul>
<p>Because an open path remains, <span class="math inline">\(A\)</span> and <span class="math inline">\(D\)</span> are statistically dependent.</p>
<p><strong>2. Dependence conditional on <span class="math inline">\(X\)</span></strong></p>
<p>If we condition on <span class="math inline">\(X\)</span>, are <span class="math inline">\(A\)</span> and <span class="math inline">\(D\)</span> statistically dependent? We first write out all paths connecting <span class="math inline">\(A\)</span> and <span class="math inline">\(D\)</span>.</p>
<ul>
<li><span class="math inline">\(A\rightarrow B \leftarrow C\rightarrow D\)</span></li>
<li><span class="math inline">\(A\leftarrow \boxed{X}\rightarrow D\)</span></li>
</ul>
<p>We then cross out the paths that are blocked</p>
<ul>
<li><span class="math inline">\(\cancel{A\rightarrow B \leftarrow C\rightarrow D}\)</span> (blocked by unconditioned collider <span class="math inline">\(B\)</span>)</li>
<li><span class="math inline">\(\cancel{A\leftarrow \boxed{X}\rightarrow D}\)</span> (blocked by conditioned non-collider <span class="math inline">\(X\)</span>)</li>
</ul>
<p>Because no open path remains, <span class="math inline">\(A\)</span> and <span class="math inline">\(D\)</span> are statistically independent.</p>
<p><strong>3. Dependence conditional on <span class="math inline">\(\{X,B\}\)</span></strong></p>
<p>If we condition on <span class="math inline">\(X\)</span> and <span class="math inline">\(B\)</span>, are <span class="math inline">\(A\)</span> and <span class="math inline">\(D\)</span> statistically dependent? We first write out all paths connecting <span class="math inline">\(A\)</span> and <span class="math inline">\(D\)</span>.</p>
<ul>
<li><span class="math inline">\(A\rightarrow B \leftarrow C\rightarrow D\)</span></li>
<li><span class="math inline">\(A\leftarrow \boxed{X}\rightarrow D\)</span></li>
</ul>
<p>We then cross out the paths that are blocked</p>
<ul>
<li><span class="math inline">\(A\rightarrow \boxed{B} \leftarrow C\rightarrow D\)</span> (open since collider <span class="math inline">\(B\)</span> is conditioned)</li>
<li><span class="math inline">\(\cancel{A\leftarrow \boxed{X}\rightarrow D}\)</span> (blocked by conditioned non-collider <span class="math inline">\(X\)</span>)</li>
</ul>
<p>Because an open path remains, <span class="math inline">\(A\)</span> and <span class="math inline">\(D\)</span> are statistically dependent.</p>
</section>
<section id="causal-identification-with-dags" class="level2">
<h2 class="anchored" data-anchor-id="causal-identification-with-dags">Causal identification with DAGs</h2>
<p>When our aim is to identify the average causal effect of <span class="math inline">\(A\)</span> on <span class="math inline">\(Y\)</span>, we want to choose a set of variables for adjustment so that all remaining paths are causal paths. We call this a sufficient adjustment set.</p>
<blockquote class="blockquote">
<p>A <strong>sufficient adjustment set</strong> for the causal effect of <span class="math inline">\(A\)</span> on <span class="math inline">\(Y\)</span> is a set of nodes that, when conditioned, block all non-causal paths between <span class="math inline">\(A\)</span> and <span class="math inline">\(Y\)</span>.</p>
</blockquote>
<p>In our example from the top of this page, there were two paths between <span class="math inline">\(A\)</span> and <span class="math inline">\(Y\)</span>:</p>
<ul>
<li><span class="math inline">\((A\text{: college degree})\rightarrow (Y\text{: employed at age 40})\)</span></li>
<li><span class="math inline">\((A\text{: college degree})\leftarrow (X\text{: top 25\% of high school class})\rightarrow (Y\text{: employed at age 40})\)</span></li>
</ul>
<p>In this example, <span class="math inline">\(X\)</span> is a sufficient adjustment set. Once we condition on <span class="math inline">\(X\)</span> by e.g.&nbsp;filtering to those in the top 25% of their high school class, the only remaining path between <span class="math inline">\(A\)</span> and <span class="math inline">\(Y\)</span> is the causal path <span class="math inline">\(A\rightarrow Y\)</span>. Thus, the difference in means in <span class="math inline">\(Y\)</span> across <span class="math inline">\(A\)</span> within subgroups defined by <span class="math inline">\(X\)</span> identifies the conditional average causal effect of <span class="math inline">\(A\)</span> on <span class="math inline">\(Y\)</span>.</p>
<p><strong>A more difficult example.</strong></p>
<p>Sufficient adjustment sets can be much more complicated. As an example, consider the DAG below.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="nonparametric_identification_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We first list all paths between <span class="math inline">\(A\)</span> and <span class="math inline">\(Y\)</span>.</p>
<ol type="1">
<li><span class="math inline">\(A\rightarrow Y\)</span></li>
<li><span class="math inline">\(A\rightarrow M\rightarrow Y\)</span></li>
<li><span class="math inline">\(A\leftarrow X_1\rightarrow X_3 \rightarrow Y\)</span></li>
<li><span class="math inline">\(A\leftarrow X_1\rightarrow X_3 \leftarrow X_2\rightarrow Y\)</span></li>
<li><span class="math inline">\(A\leftarrow X_3 \rightarrow Y\)</span></li>
<li><span class="math inline">\(A\leftarrow X_3\leftarrow X_2 \rightarrow Y\)</span></li>
</ol>
<p>The first two paths are causal, and the others are non-causal. We want to find a sufficient adjustment set to block all the non-causal paths.</p>
<p>In order to block paths (3), (5), and (6) we might condiiton on <span class="math inline">\(X_3\)</span>. But doing so opens path (2), which was otherwise blocked by the collider <span class="math inline">\(X_3\)</span>. In order to also block path (2), we might additionally condition on <span class="math inline">\(X_1\)</span>. In this case, our sufficient adjustment set is <span class="math inline">\(\{X_1,X_3\}\)</span>.</p>
<ol type="1">
<li><span class="math inline">\(A\rightarrow Y\)</span></li>
<li><span class="math inline">\(A\rightarrow M\rightarrow Y\)</span></li>
<li><span class="math inline">\(\cancel{A\leftarrow \boxed{X_1}\rightarrow \boxed{X_3} \rightarrow Y}\)</span></li>
<li><span class="math inline">\(\cancel{A\leftarrow \boxed{X_1}\rightarrow \boxed{X_3} \leftarrow X_2\rightarrow Y}\)</span></li>
<li><span class="math inline">\(\cancel{A\leftarrow \boxed{X_3} \rightarrow Y}\)</span></li>
<li><span class="math inline">\(\cancel{A\leftarrow \boxed{X_3}\leftarrow X_2 \rightarrow Y}\)</span></li>
</ol>
<p>Then the only open paths are paths (1) and (2), both of which are causal paths from <span class="math inline">\(A\)</span> to <span class="math inline">\(Y\)</span>.</p>
<p>Sometimes there are several sufficient adjustment sets. In this example, sufficient adjustment sets include:</p>
<ul>
<li><span class="math inline">\(\{X_1,X_3\}\)</span></li>
<li><span class="math inline">\(\{X_2,X_3\}\)</span></li>
<li><span class="math inline">\(\{X_1,X_2,X_3\}\)</span></li>
</ul>
<p>We sometimes call the first two minimal sufficient adjustment sets because they are the smallest.</p>
<blockquote class="blockquote">
<p>A <strong>minimal sufficient adjustment set</strong> is an adjustment set that achieves causal identification by conditioning on the fewest number of variables possible.</p>
</blockquote>
</section>
<section id="how-to-draw-a-dag" class="level2">
<h2 class="anchored" data-anchor-id="how-to-draw-a-dag">How to draw a DAG</h2>
<p>So far, we have focused on causal identification with a DAG that has been given. But how do you draw one for yourself?</p>
<p>When drawing a DAG, there is an important rule: any node that would have edges pointing into any two nodes already represented in the DAG must be included. This is because what you omit from the DAG is far more important than what you include in the DAG. Many of your primary assumptions are about the nodes and edges that you leave out.</p>
<p>For example, suppose we are estimating the causal effect of a college degree on employment at age 40. After beginning our DAG with only these variables, we have to think about any other variables that might affect these two. High school performance is one example. Then we have to include any nodes that affect any two of {high school performance, college degree, employment at age 40}. Perhaps a person’s parents’ education affects that person’s high school performance and college degree attainment. Then parents’ education should be included as an additional node. The cycle continues, so that in observational causal inference settings you are likely to have a DAG with many nodes.</p>
<p>In practice, you may not have data on all the nodes that comprise the sufficient adjustment set in your graph. In this case, we recommend that you first draw a graph under which you can form a sufficient adjustment set with the measured variables. This allows you to state one set of causal beliefs under which your analysis can answer your causal question. Then, also draw a second DAG that includes the other variables you think are relevant. This will enable you to reason about the sense in which your results could be misleading because of omitting important variables.</p>
</section>
<section id="what-to-read" class="level2">
<h2 class="anchored" data-anchor-id="what-to-read">What to read</h2>
<p>If you’d like to learn more about defining and identifying causal effects, look here:</p>
<ul>
<li>Hern'an, Miguel A. and James M. Robins. 2025. <a href="https://miguelhernan.org/whatifbook">Causal Inference: What If?</a>. Boca Raton: Chapman &amp; Hall / CRC.</li>
<li>Brand, Jennie E. 2023. <a href="https://www.russellsage.org/publications/overcoming-odds">Overcoming the Odds: The Benefits of Completing College for Unlikely Graduates.</a> Russell Sage Foundation. Here is a <a href="https://search.library.ucla.edu/permalink/01UCS_LAL/17p22dp/alma9919490742806531">link to read online through the UCLA Library</a>.</li>
</ul>
<p>If you’d like to learn from some canonical references on DAGs, look here:</p>
<ul>
<li>Pearl, Judea, and Dana Mackenzie. 2018. <a href="https://www.hachettebookgroup.com/titles/judea-pearl/the-book-of-why/9781541698963">The Book of Why: The New Science of Cause and Effect.</a> New York: Basic Books.</li>
<li>Pearl, Judea, Madelyn Glymour, and Nicholas P. Jewell. 2016. <a href="https://bayes.cs.ucla.edu/PRIMER/">Causal Inference in Statistics: A Primer.</a> New York: Wiley.</li>
<li>Pearl, Judea. 2009. <a href="https://www.cambridge.org/core/books/causality/B0046844FAE10CBF274D4ACBDAEB5F5B">Causality: Models, Reasoning, and Inference.</a> Edition 2. Cambridge: Cambridge University Press.</li>
<li>Greenland, Sander, Judea Pearl, and James M. Robins. 1999. <a href="https://journals.lww.com/epidem/abstract/1999/01000/causal_diagrams_for_epidemiologic_research.8.aspx">“Causal diagrams for epidemiologic research.”</a> Epidemiology 10(1):37–48.</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>